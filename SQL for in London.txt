-- in london, bicycle only, full datasets
select 
AVG (T0."SEVERITY") "Avg Severity",
VAR (T0."SEVERITY") "Avg Severity Variance",
SUM (T0."VEHCOUNT"),
SUM (T0."CASCOUNT")
 from 
"ROAD"."roadsafety.data::RoadF.AccFT" T0 left outer join "ROAD"."roadsafety.data::RoadF.VehF" T1
 on  T0."ACCREF" = T1."ACCREF"
 where T1."VEHTYPE" = 1  --vehtype 1 is bicycle
 and NEW ST_Polygon('Polygon((
51.69021545178133 -0.1000795593465265,
51.68262625218747 -0.1640894678953375,
51.62673844314873 -0.5003652550731252,
51.4687978441449 -0.5003020713080952,
51.37537638345922 -0.2604447782463681,
51.29248664506417 -0.1217913673590465,
51.3298782058117 -0.02055237147410183,
51.32142023464126 0.0993682688423303,
51.34618151800474 0.1346959279977478,
51.46491093248794 0.2133695972971839,
51.54192930978628 0.3296565877570212,
51.62542509952219 0.228648947683745,
51.60811732442631 0.0851277551187013,
51.67901853300752 -0.01341248134237749,
51.69021545178133 -0.1000795593465265
))').ST_Contains("LATLON") > 0; 